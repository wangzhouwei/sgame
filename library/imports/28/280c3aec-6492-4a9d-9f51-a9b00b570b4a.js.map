{"version":3,"sources":["../../../../assets/Script/assets/Script/Login.js"],"names":["cc","dd","require","messageid","functionid","Class","extends","Component","properties","loginBtn","default","type","Button","txtBtn","clickBtn","Toggle","hallmusic","url","AudioClip","helpUI","WebView","closeHelpBtn","onLoad","xx","audioMgr","playBGM","ptEvent","addObserver","Tips","init","node","on","clicklogin","ptNet","gameSocket","readyState","WebSocket","OPEN","setTimeout","show","connectNet","scheme","jsCallback","str","replace","data","JSON","stringify","setJavascriptInterfaceScheme","setOnJSCallback","onDestroy","removeObserver","loginCore","CS_LOGIN","director","loadScene","clickHelp","active","setLocalZOrder","onMessageEvent","funid","msgid","console","log","emFunction_RegLogin","SC_WEIXIN_LOGIN_P","closeHelp","window","name"],"mappings":"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","file":"Login.js","sourceRoot":"../../../../assets/Script","sourcesContent":["cc.dd = cc.dd || {};\nrequire('./Event/GameEventManager');\nvar messageid = require('F_RegLogin');\nvar functionid = require('FunctionID');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n    \t//微信登录按钮\n        loginBtn: {\n            default: null,\n            type: cc.Button,\n        },\n        //用户协议按钮\n        txtBtn: {\n            default: null,\n            type: cc.Button,\n        },\n        //点选按钮\n        clickBtn: {\n            default: null,\n            type: cc.Toggle,\n        },\n        //music\n        hallmusic:{\n            default:null,\n            url:cc.AudioClip,\n        },\n        //helpui\n        helpUI:cc.WebView,\n        closeHelpBtn:cc.Button,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        cc.xx.audioMgr.playBGM('lobbyBg.mp3');\n        cc.xx.ptEvent.addObserver(this);\n        cc.xx.Tips.init();\n        this.loginBtn.node.on('touchend',this.clicklogin,this);\n        // var state = 0, \n    // iframe = document.createElement('iframe'),\n    // loadfn = function() {\n    //     if (state === 1) {\n    //         var data = iframe.contentWindow.name;    // 读取数据\n    //         alert(data);    //弹出'I was there!'\n    //     } else if (state === 0) {\n    //         state = 1;\n    //         iframe.contentWindow.location = window.location.href;    // 设置的代理文件\n    //     }  \n    // };\n    // iframe.src = 'http://192.168.1.108:8080/testserver.html';\n    // if (iframe.attachEvent) {\n    //     iframe.attachEvent('onload', loadfn);\n    // } else {\n    //     iframe.onload  = loadfn;\n    // }\n    // document.body.appendChild(iframe);\n\n        if(!cc.xx.ptNet.gameSocket || !cc.xx.ptNet.gameSocket.readyState === WebSocket.OPEN){\n            setTimeout(() => {\n                cc.xx.Tips.show('正在链接服务器...',2000);\n                cc.xx.ptNet.connectNet(()=>{\n                // var lab = this.node.getChildByName(\"isconnected\");\n                // var tipstr = lab.getComponent(cc.Label);\n                // tipstr.string = \"链接成功啦啦啦面\"\n                    cc.xx.Tips.show('服务器链接成功',1000);\n\n                });\n            }, 200);\n        }\n        // this._connectedString = this.node.getChildByName('isconnected').getComponent(cc.Label);\n        var scheme = \"TestKey\";// 这里是与内部页面约定的关键字\n        function jsCallback (url) {\n            // 这里的返回值是内部页面的 url 数值，\n            // 需要自行解析自己需要的数据\n            var str = url.replace(scheme + '://', '');\n            var data = JSON.stringify(str);// {a: 0, b: 1}\n        }\n\n        this.helpUI.setJavascriptInterfaceScheme(scheme);\n        this.helpUI.setOnJSCallback(jsCallback);\n        \n    },\n    onDestroy(){\n        cc.xx.ptEvent.removeObserver(this);\n    },\n    clicklogin(){\n        // cc.xx.ptNet.startEvent(1,'');\n        var str = '123';\n        cc.xx.loginCore.CS_LOGIN(str);\n        cc.director.loadScene(\"hall_scene\");\n    },\n    clickHelp(){\n        this.helpUI.node.active = true;\n        this.closeHelpBtn.node.active = true;\n        this.closeHelpBtn.node.setLocalZOrder(10);\n        // this.helpUI.url = 'http://192.168.1.108:8080/testserver.html'; \n        // window.location.href=this.helpUI.url;\n        // this.helpUI.url = 'https://xxyjqp.54.com/huodong/xxpl/mobile/index.html';\n    },\n    onMessageEvent(funid,msgid,data){\n        console.log('login scene' + funid+'_'+msgid);\n        switch(funid,msgid)\n        {\n            case functionid.emFunction_RegLogin,messageid.SC_WEIXIN_LOGIN_P:\n            // cc.director.loadScene(\"hall_scene\");\n        }\n    },\n    closeHelp(){\n        this.helpUI.node.active = false;\n        this.closeHelpBtn.node.active = false;\n        cc.log('window.name' + window.name);\n    },\n});\n"]}