{"version":3,"sources":["AudioMgr.js"],"names":["cc","Class","extends","Component","properties","bgmVolume","sfxVolume","bgmAudioID","init","t","sys","localStorage","getItem","parseFloat","game","on","EVENT_HIDE","console","log","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","raw","playBGM","audioUrl","stop","play","setBGMVolume","v","setVolume","saveBGMVolume","setItem","getBGMVolume","playSFX","audioId","saveSFXVolume","setSFXVolume","getSFXVolume"],"mappings":"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","file":"AudioMgr.js","sourceRoot":"../../../../../assets/Script/xui","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bgmVolume:1.0,\n        sfxVolume:1.0,\n        \n        bgmAudioID:-1,\n    },\n\n    // use this for initialization\n    init: function () {\n        var t = cc.sys.localStorage.getItem(\"bgmVolume\");\n        if(t != null){\n            this.bgmVolume = parseFloat(t);    \n        }\n        \n        var t = cc.sys.localStorage.getItem(\"sfxVolume\");\n        if(t != null){\n            this.sfxVolume = parseFloat(t);    \n        }\n        \n        cc.game.on(cc.game.EVENT_HIDE, function () {\n            console.log(\"cc.audioEngine.pauseAll\");\n            cc.audioEngine.pauseAll();\n        });\n        cc.game.on(cc.game.EVENT_SHOW, function () {\n            console.log(\"cc.audioEngine.resumeAll\");\n            cc.audioEngine.resumeAll();\n        });\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n    \n    getUrl:function(url){\n        return cc.url.raw(\"resources/sound/\" + url);\n    },\n    \n    playBGM(url){\n        var audioUrl = this.getUrl(url);\n        console.log(audioUrl);\n        if(this.bgmAudioID >= 0){\n            cc.audioEngine.stop(this.bgmAudioID);\n        }\n        this.bgmAudioID = cc.audioEngine.play(audioUrl,true,this.bgmVolume);\n    },\n    setBGMVolume:function(v){\n        if(this.bgmVolume != v){\n            this.bgmVolume = v;\n            cc.audioEngine.setVolume(this.bgmAudioID,this.bgmVolume);\n        }\n    },\n    saveBGMVolume:function(){\n        cc.sys.localStorage.setItem(\"bgmVolume\",this.bgmVolume);\n    },\n    getBGMVolume:function(){\n        return this.bgmVolume;\n    },\n    \n    playSFX(url){\n        var audioUrl = this.getUrl(url);\n        if(this.sfxVolume > 0){\n            var audioId = cc.audioEngine.play(audioUrl,false,this.sfxVolume);    \n        }\n    },\n    saveSFXVolume:function(){\n        cc.sys.localStorage.setItem(\"sfxVolume\",this.sfxVolume);\n    },\n    setSFXVolume:function(v){\n        if(this.sfxVolume != v){\n            // cc.sys.localStorage.setItem(\"sfxVolume\",v);\n            this.sfxVolume = v;\n            // cc.audioEngine.setEffectsVolume(this.sfxVolume);\n        }\n    },\n    getSFXVolume:function(){\n        return this.sfxVolume;\n    },\n    pauseAll:function(){\n        cc.audioEngine.pauseAll();\n    },\n    \n    resumeAll:function(){\n        cc.audioEngine.resumeAll();\n    }\n});\n"]}